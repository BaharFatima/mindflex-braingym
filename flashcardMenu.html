<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Flashcard Decks</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
  html,body{height:100%;background:linear-gradient(135deg,#dceeff,#a6d9ff);
            display:flex;align-items:center;justify-content:center;}
  .app{width:320px;height:640px;background:#f0f7ff;border-radius:25px;
       box-shadow:0 10px 25px rgba(0,80,160,0.2);overflow:hidden;
       display:flex;flex-direction:column;position:relative;}
  header{background:#e6f3ff;padding:15px 20px;display:flex;
         justify-content:space-between;align-items:center;color:#003366;}
  main{flex:1;padding:20px;text-align:center;overflow-y:auto;}
  h2{color:#003366;margin-bottom:15px;}
  .deck-btn{background:linear-gradient(135deg,#66b2ff,#a3d5ff);border:none;
            color:white;border-radius:12px;padding:12px;width:100%;
            margin:10px 0;font-size:1rem;cursor:pointer;transition:transform .2s;}
  .deck-btn:hover{transform:scale(1.05);}
  .add-btn{position:absolute;bottom:90px;right:20px;background:#0077cc;
           color:white;border:none;border-radius:50%;width:45px;height:45px;
           font-size:1.6rem;cursor:pointer;box-shadow:0 3px 8px rgba(0,0,0,0.2);}

/* ===== NEW BOTTOM NAV ===== */
.bottom-nav {
  position: absolute;
  bottom: 0;
  width: 100%;
  background: white;
  border-radius: 20px 20px 0 0;
  padding: 1px 2px;
  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.08);
  display: flex;
  justify-content: space-around;
  animation: slideUp 0.5s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.menu-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 5px;
  cursor: pointer;
  transition: all 0.3s ease;
  padding: 5px;
  position: relative;
  flex: 1;
}

.menu-icon {
  width: 40px;
  height: 40px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all 0.3s ease;
  color: #5f6368;
}

.menu-icon i {
  font-size: 24px;
  transition: all 0.3s ease;
}

.menu-label {
  font-size: 10px;
  color: #5f6368;
  text-align: center;
  line-height: 1.2;
  font-weight: 600;
}

.menu-item.selected .menu-icon i {
  transform: translateY(-8px) scale(1.2);
  text-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.menu-item[data-category="cv"].selected .menu-icon i {
  color: #0D47A1;
}

.menu-item[data-category="achievements"].selected .menu-icon i {
  color: #9c27b0;
}

.menu-item[data-category="home"].selected .menu-icon i {
  color: #1565C0;
}

.menu-item[data-category="habit-tracker"].selected .menu-icon i {
  color: #ff4081;
}

.menu-item[data-category="user-account"].selected .menu-icon i {
  color: #00838F;
}

.menu-icon img {
  width: 24px;
  height: 24px;
  transition: all 0.3s ease;
  object-fit: contain;
  filter: grayscale(100%) brightness(0.7);
  border-radius: 8px;
}

.menu-item.selected .menu-icon img {
  transform: translateY(-8px) scale(1.2);
  filter: grayscale(0%) brightness(1.1) drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15));
  border-radius: 10px;
}

.menu-item[data-category="cv"].selected .menu-icon img {
  filter: grayscale(0%) brightness(1.1) drop-shadow(0 4px 8px rgba(13, 71, 161, 0.4));
}

.menu-icon .fallback-icon {
  width: 24px;
  height: 24px;
  background-color: #5f6368;
  border-radius: 8px;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  font-weight: bold;
  transition: all 0.3s ease;
}

.menu-item.selected .menu-icon .fallback-icon {
  background-color: #ff4081;
  transform: translateY(-8px) scale(1.2);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  border-radius: 10px;
}

.menu-item[data-category="cv"].selected .menu-icon .fallback-icon {
  background-color: #0D47A1;
}

@media (max-width: 320px) {
  .bottom-nav {
    padding: 10px 2px;
  }
  .menu-icon {
    width: 36px;
    height: 36px;
  }
  .menu-icon i {
    font-size: 20px;
  }
  .menu-icon img,
  .menu-icon .fallback-icon {
    width: 20px;
    height: 20px;
    border-radius: 6px;
  }
  .menu-label {
    font-size: 9px;
  }
}

</style>
</head>
<body>
  <div class="app">
    <header>
      <a href="Studyzone.html" style="text-decoration:none;color:#003366;font-size:1.4rem;">←</a>
      <h3>Flashcards</h3>
      <div></div>
    </header>

    <main>
      <h2>Your Decks</h2>
      <div id="deckList"></div>
    </main>

    <div class="bottom-nav">
      <div class="menu-item selected" data-category="cv">
        <div class="menu-icon">
          <img src="cv.png" alt="CV" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
          <div class="fallback-icon" style="display: none;">
            <i class="fas fa-file-alt"></i>
          </div>
        </div>
        <div class="menu-label">CV</div>
      </div>
      
      <div class="menu-item" data-category="achievements" onclick="window.location.href='achievements.html'">
        <div class="menu-icon">
          <i class="fas fa-trophy"></i>
        </div>
        <div class="menu-label">Achievements</div>
      </div>
      
      <div class="menu-item" data-category="home" onclick="window.location.href='main.html'">
        <div class="menu-icon">
          <i class="fas fa-home"></i>
        </div>
        <div class="menu-label">Home</div>
      </div>
      
      <div class="menu-item" data-category="habit-tracker" onclick="window.location.href='habit.html'">
        <div class="menu-icon">
          <img src="https://z-cdn-media.chatglm.cn/files/a1979dda-a3e4-4b38-b0cf-00e4ad455277_pasted_image_1762936027415.png?auth_key=1862936037-6cc8a5a356484e1cb70a8f599e1f2ce8-0-496c548f3f7ef2ea6a808a3cc812dc2c" alt="Habit Tracker" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
          <div class="fallback-icon" style="display: none;">
            <i class="fas fa-check"></i>
          </div>
        </div>
        <div class="menu-label">Habit Tracker</div>
      </div>
      
      <div class="menu-item" data-category="user-account" onclick="window.location.href='profile.html'">
        <div class="menu-icon">
          <i class="fas fa-user-circle"></i>
        </div>
        <div class="menu-label">Account</div>
      </div>
    </div>

    <button class="add-btn" onclick="window.location.href='createDeck.html'">+</button>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyD9bnmF1N44Nkuk3WZQjK9z4gRE00VRmCY",
  authDomain: "mindflex-b2a0c.firebaseapp.com",
  projectId: "mindflex-b2a0c",
  storageBucket: "mindflex-b2a0c.firebasestorage.app",
  messagingSenderId: "148676867562",
  appId: "1:148676867562:web:3365a72b6fa6b3751cee93",
  measurementId: "G-Q2T6HD3S0E"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, async (user) => {
  if (!user) {
    alert("User not logged in!");
    window.location.href = "login.html";
    return;
  }

  loadDecks(user.uid);
});

async function loadDecks(uid) {
  const list = document.getElementById('deckList');
  list.innerHTML = '';

  const snapshot = await getDocs(
    collection(db, "users", uid, "flashcardDecks")
  );

  if (snapshot.empty) {
    const msg = document.createElement('p');
    msg.textContent = "No decks yet. Tap + to create one!";
    msg.style.color = "#003366";
    msg.style.fontSize = "0.9rem";
    list.appendChild(msg);
    return;
  }

  snapshot.forEach(docSnap => {
    const deck = docSnap.data();
    const deckId = docSnap.id;

    const container = document.createElement('div');
    container.style.display = 'flex';
    container.style.justifyContent = 'space-between';
    container.style.alignItems = 'center';
    container.style.marginBottom = '10px';

    const nameBtn = document.createElement('button');
    nameBtn.textContent = deck.name;
    nameBtn.className = 'deck-btn';
    nameBtn.style.flex = '1';

    nameBtn.onclick = () => {
      localStorage.setItem('selectedDeckId', deckId);
      window.location.href = 'flashcards.html';
    };

    const editBtn = document.createElement('button');
    editBtn.innerHTML = '✏️';
    editBtn.style.marginLeft = '8px';
    editBtn.style.background = '#ffb74d';
    editBtn.style.border = 'none';
    editBtn.style.borderRadius = '8px';
    editBtn.style.padding = '8px';
    editBtn.style.cursor = 'pointer';

    editBtn.onclick = () => {
      localStorage.setItem('editDeckId', deckId);
      window.location.href = 'editDeck.html';
    };

    container.appendChild(nameBtn);
    container.appendChild(editBtn);
    list.appendChild(container);
  });
}
</script>
</body>
</html>